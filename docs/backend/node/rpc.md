# RPC

## 是什么

Remote Procedure Call（远程过程调用）

- 和 Ajax 有什么相同点？

  - 都是 2 个计算机之间的网络通信
  - 需要双方约定一个数据格式

- 和 Ajax 有什么不同点？

  - 不一定使用 DNS 作为寻址服务
  - 应用层协议一般不使用 HTTP（可能使用一些二进制协议，会有性能上的优势）
  - 基于 TCP 或 UDP 协议

- 寻址/负载均衡

  - Ajax：使用 DNS 进行寻址
  - RPC：使用特有服务进行寻址

- TCP 通信方式

  - 单工通信： 要么 C 向 S 发包，要么 S 向 C 发包
  - 半双工通信： 同一时间内只能有一方给另一方发送数据，可以理解为轮番单工通信
  - 全双工通信：不受限制

- 二进制协议
  - 更小的数据包体积
  - 更快的编解码速率

## Node.js Buffer 编解码二进制数据包

使用 node 原生写 buffer 会比较麻烦，解决方案：

[node protocol-buffer](https://www.npmjs.com/package/protocol-buffers)

## Node.js net 建立多路复用的 RPC 通道

- 单工/半双工的通信通道搭建
  - 关键在于应用层协议需要有标记包号的字段
  - 处理以下情况，需要有标记包长度的字段
    - 粘包
    - 不完整包
  - 错误处理
